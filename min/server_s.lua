function pageHandler(a,b,c)local d,e,f=nil,b:sub(b:find("(%.)")+1),file.open(b..".gz","r")if f~=nil then d=file.stat(b..".gz")if b=='index.html'or type=='html'then a:send('HTTP/1.1 200 OK\r\nContent-Type: text/html\r\nContent-Encoding: gzip\r\nCache-Control: max-age='..c..'\r\nContent-Length:'..d.size.."\n\n")elseif e=='css'then a:send('HTTP/1.1 200 OK\r\nContent-Type: text/css\r\nContent-Encoding: gzip\r\nCache-Control: max-age='..c..'\r\nContent-Length:'..d.size.."\n\n")elseif e=='js'then a:send('HTTP/1.1 200 OK\r\nContent-Type: application/x-gzip\r\nContent-Encoding: gzip\r\nCache-Control: max-age='..c..'\r\nContent-Length:'..d.size.."\n\n")elseif e=='ico'then a:send('HTTP/1.1 200 OK\r\nContent-Type: image/x-icon\r\nContent-Encoding: gzip\r\nCache-Control: max-age='..c..'\r\nContent-Length:'..d.size.."\n\n")end;a:send(f.read(d.size))f.close()d=nil else local g=file.open('404.html.gz',"r")d=file.stat('404.html.gz')if g then a:send('HTTP/1.1 200 OK\r\nContent-Type: text/html\r\nContent-Encoding: gzip\r\nCache-Control: max-age='..c..'\r\nContent-Length:'..d.size.."\n\n")a:send(g.read(d.size))g.close()else dofile('errors.lua')a:send(e500)end;g=nil end;f,type,d=nil,nil,nil end
