function decode(a)node.egc.setmode(node.egc.ALWAYS)local b=string.byte;local c=bit.band;local d=bit.bor;local e=bit.rshift;local f=bit.lshift;local g=string.sub;local h=crypto.mask;local i=#a;if i<2 then return end;local j=b(a,2)local k=c(j,0x7f)local l;if k==126 then if i<4 then return end;k=d(f(b(a,3),8),b(a,4))l=4 elseif k==127 then if i<10 then return end;k=d(f(b(a,7),24),f(b(a,8),16),f(b(a,9),8),b(a,10))l=10 else l=2 end;local m=c(j,0x80)>0;if m then l=l+4 end;if i<l+k then return end;local n=b(a,1)local o=g(a,l+1,l+k)assert(#o==k,"Length mismatch")if m then o=h(o,g(a,l-3,l))end;local p=g(a,l+k+1)local q=c(n,0xf)return p,o,q end
